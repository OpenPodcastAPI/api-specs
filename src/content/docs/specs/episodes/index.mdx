---
title: Episodes endpoint
description: An endpoint for syncing episodes between devices.
prev: "Subscriptions: Deletion status endpoint"
sidebar:
  label: Overview
  order: 1
---

import CoreEndpoint from "@partials/_core-endpoint.mdx";

<CoreEndpoint />

The episodes endpoint allows synchronising user-generated episode metadata. As the RSS feed is the authoritative source of truth, episode metadata such as title are only synchronised in some cases for episode identification and matching.

Clients can query the endpoint by specifying the datetime from which they want to fetch changes to ensure they only fetch information that is relevant to them since their last sync.

## Important data fields

We distinguish two types of data fields: _identifier fields_ (used to identify and match episodes) and _data fields_ (used to synchronise users' interaction with episodes).

:::note[Tombstoning]
Servers SHOULD hold all previous `guid` and `feed_url` field data with a link to the succeeding data (such that a path of values can be followed) or with a link to the most recent data. This enables the server to handle situations in which clients submit old data. For example:

- A user finds a podcast, whose URL had changed, and adds the old URL in the app. Because the client doesn't have the old URL in its database, it recognizes the podcast as **new** and POSTs the `feed_url` to the `/subscriptions` endpoint. If the user is already subscribed to the podcast (with the current feed URL) this would lead to a duplicate subscription.
- A user has a device that they didn't use for a very long time. In that time, a podcaster added a GUID in their feed, leading to updated data in this field. When the client connects to the server again to pull all episode changes since the last connection, it retrieves episodes with their current subscription `guid`. The client won't recognize the subscription and fail to update the status of episodes.
  :::

### Identifier fields

| Field                  | Type           | Nullable? | Description                                                                                                                                                                                     |
| ---------------------- | -------------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `podcast_guid`         | String \<UUID\> | No        | The globally unique ID of the podcast                                                                                                                                                           |
| `sync_id`              | String \<UUID\> | No        | The synchronisation ID of the episode, globally unique at the server and its clients                                                                                                            |
| `episode_guid`         | String \<UUID\> | Yes       | The globally unique ID of the episode, as present in the RSS feed ([`guid` tag](https://www.rssboard.org/rss-specification#ltguidgtSubelementOfLtitemgt)                                        |
| `title`                | String         | Yes       | The title of the episode, as present in the RSS feed (`title` tag)                                                                                                                              |
| `publish_date`         | Datetime       | Yes       | The date of publishing of the episode, as present in the RSS feed ([`pubDate` tag](https://www.rssboard.org/rss-specification#ltpubdategtSubelementOfLtitemgt)). Presented in [ISO 8601 format] |
| `enclosure_url`        | String         | Yes       | The media file of the episode, as present in the RSS feed ([`enclosure` tag](https://www.rssboard.org/rss-specification#ltenclosuregtSubelementOfLtitemgt))                                     |
| `episode_url`          | String         | Yes       | The (webpage) URL of the episode, as present in the RSS feed (`link`tag)                                                                                                                        |
| `duration`             | Integer        | Yes       | ???                                                                                                                                                                                             |

:::note[Episode matching & deduplication]
TODO: Describe or reference to information about episode matching and deduplication. See https://pad.funkwhale.audio/2iNOQ2N2RF-ICMQcPWyyYQ#
:::

### Data fields

| Field                               | Type           | Nullable? | Description                                                                                                                                    |
| ----------------------------------- | -------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| `playback_position`                 | Integer        | Yes/No?   | The most recent playback position                                                                                                              |
| `played_status`                     | Boolean        | No        | Whether the episode has ben (marked as)                                                                                                        |
| `new_status` <BadgeOptional />      | Boolean        | Yes       | Whether the user (manually) interacted with the episode.<br />_Example:_ In AntennaPod this is used to indicate whether an episode is in the Inbox |
| `download_status` <BadgeOptional /> | Boolean        | Yes       | Whether the episode is downloaded on the client. For further details, see below.
| `favorite_status` <BadgeOptional /> | Boolean        | Yes       | Whether the episode has been favorited by the user

:::note[Potential future fields]
- Bookmarks: timed bookmarks of this episode with optinally a description text. Related to AntennaPod feature request [#1946](https://github.com/AntennaPod/AntennaPod/issues/1946).
- Tags: labels applied to this episode. Related to Kasts feature request // Can we add a URL as reference?
:::

## Implementation details
### Deduplication

// Maybe explain here? Or move to different page?

### Download status

// Expect client to respect download status if enabled. Delayed download (e.g. wait for WiFi) is permitted. ([discussion details](https://pad.funkwhale.audio/s/88C5eXrRq))

## Conflicting field values

## Timestamping changes

Apps are expected to record the _time at which a field value was changed in the client_ (by the user or system), rather than the time of sending by the client or processing by the client.

Scenario:
1. User marks episode as played on client A, which is offline.
2. User plays episode halfway through on client B, which is offline.
3. Client B comes online and synchronises changes.
4. Client A comes online and synchronises changes.

In this case, the changes made on client B should take presedence, as they were made later in time than the changes on client A, even though client A most recently synchronised its data.

[ISO 8601 format]: https://www.iso.org/iso-8601-date-and-time-format.html
